<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Lab03_B--IntroductionToShellScripting</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

pre,code{font:12px Monaco,"Courier New","DejaVu Sans Mono","Bitstream Vera Sans Mono",monospace;}


body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}
* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>

<style type="text/css">
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #a67f59;
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
</style>


</head>

<body>

<h1 id="toc_0">Bioe 421/521: Microcontroller Applications</h1>

<h4 id="toc_1">Instructor: Jordan Miller<br>TA: Madeleine Gomel<br>github.com/jmil/Bioe421_521-MicrocontrollerApplications</h4>

<h2 id="toc_2">Lab 3B. Introduction to Shell Scripting</h2>

<p>So far, we&#39;ve learned about the command-line terminal (a.k.a. the <strong>shell</strong>), and how to run basic commands like <code>cp</code> and <code>pwd</code> (you remember what those stand for, right? How could you look them up?). We&#39;ve also covered using the <strong>pipe</strong> character (<strong><code>|</code></strong>) to make more complicated logical programs by passing <strong>STDOUT</strong> from one command as <strong>STDIN</strong> to the next one. However, what&#39;s the point of having a computer if we have to manually type each program each time we want to run it?</p>

<p>It would be <strong>MUCH</strong> better if we had a way to save our most cleverly devised commands and single-line programs. Even better, we&#39;d like to be able to save programs in a way that makes it easy to re-use our programs later and run them without much hassle.</p>

<p>If you think about it carefully, we already have a solution. As we learned in lecture, each character of each command you type at the command prompt may appear to be English to you, but the computer understands things at the most fundamental, binary level (remember learning about the <strong>ASCII</strong> text format?). And... you already know how to create and save text files using the <code>nano</code> command.</p>

<p>So, all we need to do is create a text file in <code>nano</code> with a list of your commands, and then have your <strong>shell</strong> call that list of commands, in order. You want to start a <strong>dialogue</strong> between the computer and your text file. Thus, this type of file is conventionally known as a <strong>script</strong>. A carriage-return at the command-prompt is akin to a newline in a text file. So if we have one command per line, then each command will be executed in order from top to bottom of our <strong>script</strong>.</p>

<p>As we learned in class, the best command-line programs are <em>narrow</em> in task or goal, allowing for easy testing and debugging, as well as maximal modularity and re-use.</p>

<p>So today we will learn how to write a <strong>script</strong> to store our programs.</p>

<p>But first we need to say a bit about syntax.</p>

<h3 id="toc_3">The Bang! The Bash! The Whole Shebang!</h3>

<p>You already saw hints of shell scripting in the previous Lab, where we had to edit the <code>.bashrc</code> file. There were lots of commands in there! Let&#39;s take a look again:</p>

<div><pre><code class="language-none">$ cat ~/.bashrc | more</code></pre></div>

<p>So, our <strong>script</strong> will be a flat list of commands written in plain <strong>ASCII</strong> text. But how will the computer know what text files on our computer are just text and which are commands? It would take a long time to run the <code>web2</code> file as a <strong>script</strong>! We need to make it easy for the computer to notice that our file is a <strong>script</strong> and not strictly a text file. We want our <strong>script</strong> to be <em>interpreted as a program</em>. </p>

<p>To do this, we use what&#39;s called the <strong>shebang</strong> at the very beginning of our text file:<br>
<a href="http://en.wikipedia.org/wiki/Shebang_(Unix)">http://en.wikipedia.org/wiki/Shebang_(Unix)</a></p>

<blockquote>
<p>In computing, a shebang is the character sequence consisting of the characters number sign and exclamation mark (that is, <strong><code>#!</code></strong>) at the beginning of a script.</p>

<p>Under Unix-like operating systems, when a script with a shebang is run as a program, the program loader parses the rest of the script&#39;s initial line as an interpreter directive; the specified interpreter program is run instead, passing to it as an argument the path that was initially used when attempting to run the script.</p>
</blockquote>

<p>So... you start a text file (usually given the file extension <code>.sh</code> to denote a <strong>sh</strong>ell script) with the following line:</p>

<div><pre><code class="language-none">    #! /bin/bash</code></pre></div>

<p>The <strong><code>#</code></strong> sign denotes the line is a comment, <strong>BUT</strong> the <strong><q>bang</q></strong> (<strong><code>!</code></strong>) indicates to the shell interpreter that the file should be processed as a series of commands, in this case interpreted by the <code>bash</code> shell. Together, the <strong><code>#!</code></strong> is called the <strong>shebang</strong>.</p>

<p>Read this carefully, it can be confusing. An advantage of putting the whole <strong>shebang</strong> at the beginning of your file is that it communicates to other people, as well as to computers, exactly the syntax that will be followed in your script. There is more than one type of <strong>shell</strong>, so we need to know which one to use to run our <strong>script</strong>.</p>

<p>Let&#39;s learn by example. A <code>bash</code> script you should use as a template is available here:<br>
<a href="https://github.com/jmil/Bioe421_521-MicrocontrollerApplications/raw/master/Attachments/bash-script.sh">https://github.com/jmil/Bioe421_521-MicrocontrollerApplications/raw/master/Attachments/bash-script.sh</a></p>

<p>Do you remember how to pull down this file using <code>wget</code>? You might want to use a URL shortener.</p>

<p>Grab the template file and run it. You will have to change permissions on the file in order to execute it:</p>

<div><pre><code class="language-none">$ chmod +x bash-script.sh
$ ./bash-script.sh</code></pre></div>

<p>What happened when you ran the script?</p>

<h3 id="toc_4">Your <code>$PATH</code> to Success</h3>

<p>If you look at the sample <code>bash-script.sh</code> you will notice a lot is going on:</p>

<div><pre><code class="language-none">$ cat bash-script.sh | more</code></pre></div>

<p>Some variables are built-in to the <strong>shell</strong> already, such as <code>$USER</code> and <code>$PATH</code> (they don&#39;t have to be defined in your script). You can check with:</p>

<div><pre><code class="language-none">$ echo $USER
$ echo $PATH</code></pre></div>

<p>Other variables can be set with simple assignment using the <strong><code>=</code></strong> character as you did when editing your prompt. You can also have variable variables, which are not set until the script is run. Recall: these are set with the backtick <strong><code>`</code></strong> character to escape you to a temporary <strong>shell</strong> to run the command and set its <strong>STDOUT</strong> as input to the variable. This allows you to, for example, set a variable for the exact time the script was run and splice that output into your commands as plain text. Check the <code>bash-script.sh</code> carefully to find this section.</p>

<h3 id="toc_5">More Input</h3>

<p>Another useful part of the shell -- you can take user input as text to be used directly in your script. But how can you use user input <strong>from the future</strong> in a script you are writing right now? Instead of using variables with the <code>$</code> prefix on the command prompt, we can use them in our script.</p>

<p>User input options will be assigned to integer variables in numerical order. We will use <code>nano</code> to write a <code>bash</code> script that takes three user-input text strings at the command prompt and outputs them in reverse order. The syntax we want to achieve should be:</p>

<div><pre><code class="language-none">    $ ./user_input.sh value1 value2 value3
    OUTPUT:
    value3, value2, value1</code></pre></div>

<p>Let&#39;s begin.</p>

<ol>
<li><p>Generate the <code>scripts</code> folder to contain everything:</p>

<div><pre><code class="language-none">$ cd ~
$ mkdir scripts
$ cd scripts</code></pre></div></li>
<li><p>Create a new file <code>user_input.sh</code> and edit it with <code>nano</code>:</p>

<div><pre><code class="language-none">$ nano user_input.sh</code></pre></div>

<p>Make the file contents to be the following:</p>

<div><pre><code class="language-none">#! /bin/bash

echo &quot;$3, $2, $1&quot;</code></pre></div></li>
<li><p>Save and exit.</p>

<p>Now try it out!</p>

<div><pre><code class="language-none">$ chmod +x user-input.sh
$ ./user-input.sh value1 value2 value3</code></pre></div>

<p>What was the script output?</p>

<div><pre><code class="language-none">:</code></pre></div>

<p>How did that happen? The magic happens at this line of your script:</p>

<div><pre><code class="language-none">echo &quot;$3, $2, $1&quot;</code></pre></div>

<p>The bash shell <strong>automagically</strong> creates variables for you when you run a script, and assigns the first word to <code>$1</code>, the second to <code>$2</code>, and the third to <code>$3</code>. It&#39;s <strong><em>as if</em></strong> your script actually read as:</p>

<div><pre><code class="language-none">#! /bin/bash

1=&quot;value1&quot;
2=&quot;value2&quot;
3=&quot;value3&quot;
echo &quot;$3, $2, $1&quot;</code></pre></div>

<p>But it happens dynamically, and takes the user input as the value to assign to the numbered variables.</p></li>
</ol>

<h2 id="toc_6">Assignment: Generate the following Scripts</h2>

<p>Make sure you are working inside your <code>scripts</code> folder:</p>

<div><pre><code class="language-none">$ cd ~/scripts</code></pre></div>

<h4 id="toc_7">make_script.sh</h4>

<p>Let&#39;s start by making a script that will help you make more scripts: you want it to create a new file based on an online template, write out the template into a new user-specified file, and <code>chmod +x</code> this new file so it will immediately be executable.</p>

<p>Given that the <strong>next</strong> assignment below will be to make a <code>weather.sh</code> script, it would be great if we could automatically pull down the Bioe421/521 script template, name it what we want, and make it executable. So for this <code>make_script.sh</code>, we want the user to be able to run:</p>

<div><pre><code class="language-none">$ ./make_script.sh weather</code></pre></div>

<p>And have it generate <code>weather.sh</code> ready to be edited and then immediately executed.</p>

<p>We will be making a bunch of scripts, so the workflow will be:</p>

<ol>
<li>make a script</li>
<li>make a script, then get a file</li>
<li>make a script, then get a file, then make the script executable within itself</li>
<li>make a script, then get a file, then make the script executable within itself, then allow for user input</li>
</ol>

<p>Let&#39;s get started. I put a script template you should use at:</p>

<div><pre><code class="language-none">    https://github.com/jmil/Bioe421_521-MicrocontrollerApplications/raw/master/Attachments/bash-script.sh</code></pre></div>

<ol>
<li><p>Write a one-line program to put the contents of the file at this URL into a new file named <code>get-script.sh</code>. Write the program (after you&#39;re sure it works!) here:</p>

<div><pre><code class="language-none">$ </code></pre></div></li>
<li><p>Use <code>nano</code> to edit <code>get-script.sh</code> to, itself, grab the <code>bash-script.sh</code> template from github and output it to <code>STDOUT</code>. Of course, you will have to <code>chmod +x</code> this script to make it executable. Once you have done so, this is a good time to test your script. Modularization and testing on a line-by-line basis is the way to go. What happens when you run:</p>

<div><pre><code class="language-none">$ ./make_script.sh</code></pre></div>

<p>Describe the output:</p>

<div><pre><code class="language-none">:</code></pre></div></li>
<li><p>Modify your script to take input from the user, and use this user input to set the filename of a new script file on your hard drive that will be generated from a live copy of the <code>bash-script.sh</code> file on github. What happens when you now run:</p>

<div><pre><code class="language-none">$ ./make_script.sh weather</code></pre></div>

<p>Describe the result:</p>

<div><pre><code class="language-none">:</code></pre></div></li>
<li><p>Next, modify <code>get-script.sh</code> to also run the command <code>chmod +x</code> on your newly created <code>weather.sh</code> script file to make it executable right after it&#39;s created. Describe the result and how you checked it if the new <code>weather.sh</code> was executable:</p>

<div><pre><code class="language-none">:</code></pre></div></li>
<li><p>Finally, we don&#39;t want to have to delete all those extra lines each time we make a new script. So, edit the <code>get-script.sh</code> file to grab <strong>ONLY</strong> the 15 lines of the <code>bash_script.sh</code> file to use as a template. Describe your modifications:</p>

<div><pre><code class="language-none">:</code></pre></div></li>
</ol>

<h3 id="toc_8">weather.sh</h3>

<ol>
<li><p>Use <code>nano</code> to write a <code>bash</code> script that grabs the current local weather. You will need to install the <code>weather-util</code> command:</p>

<div><pre><code class="language-none">$ sudo apt-get install weather-util</code></pre></div>

<p><strong>NOTE:</strong> As of August 23rd, 2016 the NOAA WX weather products URLs were deprecated. This means <code>weather-util</code> won&#39;t work out of the box. e.g. if we use the 4-character code location for Houston Hobby Airport and run <code>weather KHOU</code> you may see an error like:</p>

<div><pre><code class="language-none">$ weather KHOU
Searching via station...
[caching result Houston Hobby Airport, TX, United States]
weather error: failed to retrieve
   http://weather.noaa.gov/pub/data/observations/metar/decoded/KHOU.TXT
   HTTPError: HTTP Error 404: Not Found</code></pre></div>

<p>But, an updated file has been created by the developer, so we next need to get the latest files with <code>git</code> and overwrite the files that were installed with the <code>weather-util</code> package:</p>

<div><pre><code class="language-none">$ cd ~
$ mkdir weather-pkg
$ cd weather-pkg
$ git clone http://www.yuggoth.org/git/weather.git
$ cd weather
$ ls -la</code></pre></div>

<p>Make sure you have a <code>stations</code> file. We next need to copy this file to <code>/usr/share/weather/</code>:</p>

<div><pre><code class="language-none">$ sudo cp stations /usr/share/weather-util/</code></pre></div>

<p>Check that it&#39;s there with:</p>

<div><pre><code class="language-none">$ ls -la /usr/share/weather-util/</code></pre></div>

<p>Now, using the airport code location for Houston Hobby Airport you can run something like:</p>

<div><pre><code class="language-none">$ weather hou
Searching via airport...
[caching result Houston Hobby Airport, TX, United States]
Current conditions at Houston Hobby Airport, TX
Last updated Aug 29, 2016 - 01:53 PM EDT / 2016.08.29 1753 UTC
   Temperature: 77.0 F (25.0 C)
   Relative Humidity: 87%
   Wind: from the E (100 degrees) at 12 MPH (10 KT)
   Weather: Lightning observed
   Sky conditions: mostly cloudy
   Precipitation last hour: A trace</code></pre></div>

<p>This may take some time. Be patient! Recall that you can use <code>grep</code> to parse this text a bit (remember that text given to <code>grep</code> is case-sensitive):</p>

<div><pre><code class="language-none">$ weather hou | grep Temperature
   Temperature: 77.0 F (25.0 C)</code></pre></div></li>
<li><p>Modify your script to have the weather data saved to a file named with the current time and located at <code>/home/pi/weather/</code>.<br>
<strong>Hints:</strong> You will want to use the <code>date</code> command and look at it&#39;s formatting options:</p>

<div><pre><code class="language-none">$ man date</code></pre></div>

<p>You likely also want to use the <code>-p</code> flag of the <code>mkdir</code> command.</p></li>
<li><p>You might get a warning when running <code>weather -i</code>. Modify your script to suppress this <strong>STDERR</strong> by sending it to <strong>STDOUT</strong> and then using a piped <code>tail</code> to show output starting at the 4th line. You will want to check the man page for <code>tail</code> to see how to show output relative to the beginning of the input.</p></li>
</ol>

<h3 id="toc_9">robots.sh</h3>

<ol>
<li>Use <code>nano</code> to write a <code>bash</code> script that grabs the <code>http://www.google.com/robots.txt</code> file and sends the output to <strong>STDOUT</strong>.</li>
<li>Modify your script to take input from the user, and use this user input to constrain the output (<strong>hint:</strong> think about constraining which line numbers are output).</li>
</ol>

<h3 id="toc_10">word.sh</h3>

<ol>
<li>Use <code>nano</code> to write a <code>bash</code> script to <code>grep</code> the <code>web2</code> dictionary for the string <code>wow</code>.</li>
<li>Modify your script to take input from the user, and use this user input as the pattern used by the <code>grep</code> command to find a match.</li>
</ol>

<h3 id="toc_11">selfie.sh</h3>

<ol>
<li>Use <code>nano</code> to write a <code>bash</code> script that uses the RaspberryPi Camera to take a selfie of you and your teammate. Name the image after your team name. You will want to hardcode the location where images should be stored to be <code>/home/pi/raspicam/</code>.
<strong>HINT:</strong> You likely want to use the <code>-p</code> flag of the <code>mkdir</code> command.</li>
<li>To have good camera functionality, you won&#39;t want to overwrite your previous images every time a photo is taken. Modify your <code>selfie.sh</code> script to append the current timestamp to your filename so they won&#39;t be overwritten.</li>
</ol>

<h3 id="toc_12">Homework Submission</h3>

<ol>
<li><p>move all of your scripts, pics, and weather info into a folder following the demonstrated naming convention for <code>Team09-LambdaFTW</code>. <strong>Make sure there are no spaces in your team name identifier</strong>. And, the trailing <code>/</code> characters here have specific meaning... don&#39;t forget them!</p>

<div><pre><code class="language-none">$ cd ~
$ mkdir Team09-LambdaFTW_Lab03
$ mv raspicam Team09-LambdaFTW_Lab03/
$ mv scripts Team09-LambdaFTW_Lab03/
$ mv weather Team09-LambdaFTW_Lab03/</code></pre></div></li>
<li><p>Zip up the folder to make a single .zip file</p>

<div><pre><code class="language-none">$ sudo apt-get update
$ sudo apt-get install zip
$ zip -r Team09-LambdaFTW_Lab03.zip Team09-LambdaFTW_Lab03</code></pre></div></li>
<li><p><code>scp</code> your team&#39;s homework .zip file to your Instructor&#39;s RaspberryPi. Your Instructor will provide you with the value to enter for <strong>IP_ADDRESS</strong>. Use your same <code>raspberry</code> password (note that you are logging in as user <code>student</code>):</p>

<div><pre><code class="language-none">$ man scp
$ scp Team09-LambdaFTW_Lab03.zip student@IP_ADDRESS:/home/student/</code></pre></div></li>
</ol>

<h2 id="toc_13">Shutdown Procedure</h2>

<ol>
<li><p>Shutdown your Pi properly:</p>

<div><pre><code class="language-none">$ sudo shutdown -h now</code></pre></div>

<p>Unplug everthing and restore the Windows desktop computer to a working state.</p></li>
</ol>



<script type="text/javascript">
var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var e=/\blang(?:uage)?-(\w+)\b/i,t=0,n=_self.Prism={util:{encode:function(e){return e instanceof a?new a(e.type,n.util.encode(e.content),e.alias):"Array"===n.util.type(e)?e.map(n.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e){var t=n.util.type(e);switch(t){case"Object":var a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=n.util.clone(e[r]));return a;case"Array":return e.map&&e.map(function(e){return n.util.clone(e)})}return e}},languages:{extend:function(e,t){var a=n.util.clone(n.languages[e]);for(var r in t)a[r]=t[r];return a},insertBefore:function(e,t,a,r){r=r||n.languages;var l=r[e];if(2==arguments.length){a=arguments[1];for(var i in a)a.hasOwnProperty(i)&&(l[i]=a[i]);return l}var o={};for(var s in l)if(l.hasOwnProperty(s)){if(s==t)for(var i in a)a.hasOwnProperty(i)&&(o[i]=a[i]);o[s]=l[s]}return n.languages.DFS(n.languages,function(t,n){n===r[e]&&t!=e&&(this[t]=o)}),r[e]=o},DFS:function(e,t,a,r){r=r||{};for(var l in e)e.hasOwnProperty(l)&&(t.call(e,l,e[l],a||l),"Object"!==n.util.type(e[l])||r[n.util.objId(e[l])]?"Array"!==n.util.type(e[l])||r[n.util.objId(e[l])]||(r[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,l,r)):(r[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,null,r)))}},plugins:{},highlightAll:function(e,t){var a={callback:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",a);for(var r,l=a.elements||document.querySelectorAll(a.selector),i=0;r=l[i++];)n.highlightElement(r,e===!0,a.callback)},highlightElement:function(t,a,r){for(var l,i,o=t;o&&!e.test(o.className);)o=o.parentNode;o&&(l=(o.className.match(e)||[,""])[1],i=n.languages[l]),t.className=t.className.replace(e,"").replace(/\s+/g," ")+" language-"+l,o=t.parentNode,/pre/i.test(o.nodeName)&&(o.className=o.className.replace(e,"").replace(/\s+/g," ")+" language-"+l);var s=t.textContent,u={element:t,language:l,grammar:i,code:s};if(!s||!i)return n.hooks.run("complete",u),void 0;if(n.hooks.run("before-highlight",u),a&&_self.Worker){var c=new Worker(n.filename);c.onmessage=function(e){u.highlightedCode=e.data,n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(u.element),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},c.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=n.highlight(u.code,u.grammar,u.language),n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(t),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},highlight:function(e,t,r){var l=n.tokenize(e,t);return a.stringify(n.util.encode(l),r)},tokenize:function(e,t){var a=n.Token,r=[e],l=t.rest;if(l){for(var i in l)t[i]=l[i];delete t.rest}e:for(var i in t)if(t.hasOwnProperty(i)&&t[i]){var o=t[i];o="Array"===n.util.type(o)?o:[o];for(var s=0;s<o.length;++s){var u=o[s],c=u.inside,g=!!u.lookbehind,h=!!u.greedy,f=0,d=u.alias;u=u.pattern||u;for(var p=0;p<r.length;p++){var m=r[p];if(r.length>e.length)break e;if(!(m instanceof a)){u.lastIndex=0;var y=u.exec(m),v=1;if(!y&&h&&p!=r.length-1){var b=r[p+1].matchedStr||r[p+1],k=m+b;if(p<r.length-2&&(k+=r[p+2].matchedStr||r[p+2]),u.lastIndex=0,y=u.exec(k),!y)continue;var w=y.index+(g?y[1].length:0);if(w>=m.length)continue;var _=y.index+y[0].length,P=m.length+b.length;if(v=3,P>=_){if(r[p+1].greedy)continue;v=2,k=k.slice(0,P)}m=k}if(y){g&&(f=y[1].length);var w=y.index+f,y=y[0].slice(f),_=w+y.length,S=m.slice(0,w),O=m.slice(_),j=[p,v];S&&j.push(S);var A=new a(i,c?n.tokenize(y,c):y,d,y,h);j.push(A),O&&j.push(O),Array.prototype.splice.apply(r,j)}}}}}return r},hooks:{all:{},add:function(e,t){var a=n.hooks.all;a[e]=a[e]||[],a[e].push(t)},run:function(e,t){var a=n.hooks.all[e];if(a&&a.length)for(var r,l=0;r=a[l++];)r(t)}}},a=n.Token=function(e,t,n,a,r){this.type=e,this.content=t,this.alias=n,this.matchedStr=a||null,this.greedy=!!r};if(a.stringify=function(e,t,r){if("string"==typeof e)return e;if("Array"===n.util.type(e))return e.map(function(n){return a.stringify(n,t,e)}).join("");var l={type:e.type,content:a.stringify(e.content,t,r),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:r};if("comment"==l.type&&(l.attributes.spellcheck="true"),e.alias){var i="Array"===n.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(l.classes,i)}n.hooks.run("wrap",l);var o="";for(var s in l.attributes)o+=(o?" ":"")+s+'="'+(l.attributes[s]||"")+'"';return"<"+l.tag+' class="'+l.classes.join(" ")+'" '+o+">"+l.content+"</"+l.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(e){var t=JSON.parse(e.data),a=t.language,r=t.code,l=t.immediateClose;_self.postMessage(n.highlight(r,n.languages[a],a)),l&&_self.close()},!1),_self.Prism):_self.Prism;var r=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return r&&(n.filename=r.src,document.addEventListener&&!r.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",n.highlightAll)),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism);
</script>

<script type="text/x-mathjax-config">
(function () {

MathJax.Hub.Config({
	'showProcessingMessages': false,
	'messageStyle': 'none'
});

if (typeof MathJaxListener !== 'undefined') {
	MathJax.Hub.Register.StartupHook('End', function () {
		MathJaxListener.invokeCallbackForKey_('End');
	});
}

})();
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


</body>

</html>
